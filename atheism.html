<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="testtesttest.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vtheology</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            color: #333;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 260px;
            background: linear-gradient(to bottom, #1b1b1b, #ffffff);
            color: white;
            padding: 0;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
            height: 100vh;
            position: relative;
            border-right: 1px solid #e9ecef;
        }

        .sidebar h2 {
            text-align: center;
            margin: 0;
            padding: 20px;
            font-size: 24px;
            position: sticky;
            top: 0;
            background: linear-gradient(to bottom, #4b4a4a, #a29999);
            z-index: 10;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        /* Custom Scrollbar for Sidebar */
        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: #1e7e34;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: #ffffff;
            border-radius: 4px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: #f8f9fa;
        }

        #nav-menu {
            padding: 10px 0 20px 0;
        }

        .nav-item {
            padding: 15px 20px;
            cursor: pointer;
            transition: background-color 0.3s ease, border-left-color 0.3s ease;
            border-left: 4px solid transparent;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .nav-item:hover {
            background-color: #4b4b4b;
            border-left-color: white;
        }

        .nav-item.active {
            background-color: #000000;
            border-left-color: white;
        }

        .nav-item.disclaimer {
            background-color: #272626;
        }

        .nav-item.disclaimer:hover {
            background-color: #000000;
        }

        .nav-item.quotes {
            background-color: #0b3d91;
        }

        .nav-item.quotes:hover {
            background-color: #0e4cab;
        }

        .nav-item.hadiths {
            background-color: #a94700;
        }

        .nav-item.hadiths:hover {
            background-color: #cc5a00;
        }

        .nav-item.jesus_messiah {
            background-color: #b8860b;
        }

        .nav-item.jesus_messiah:hover {
            background-color: #d4a017;
        }

        .sub-menu {
            display: none;
            background-color: rgba(0,0,0,0.1);
            border-left: 3px solid #ffffff;
            margin-left: 10px;
        }

        .sub-menu.show {
            display: block;
        }

        .sub-nav-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            font-size: 14px;
        }

        .sub-nav-item:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .sub-nav-item.active {
            background-color: rgba(255,255,255,0.15);
            font-weight: bold;
        }

        


        

        .sub-menu.disclaimer {
            background-color: rgba(102, 7, 210, 0.1);
            border-left: 3px solid #ffffff;
        }

        .sub-menu.quotes {
            background-color: rgba(11, 61, 145, 0.2);
            border-left: 3px solid #ffffff;
        }

        .sub-nav-item.disclaimer {
            background-color: #4f0234;
        }

        .sub-nav-item.disclaimer:hover {
            background-color: #6e0449;
        }

        .sub-nav-item.disclaimer.active {
            background-color: rgba(255,255,255,0.15);
            font-weight: bold;
        }

        .sub-nav-item.quotes {
            background-color: #092a68;
        }

        .sub-nav-item.quotes:hover {
            background-color: #0d3a86;
        }

        .sub-nav-item.quotes.active {
            background-color: rgba(255,255,255,0.15);
            font-weight: bold;
        }

        .sub-menu.hadiths {
            background-color: rgba(169, 71, 0, 0.2);
            border-left: 3px solid #ffffff;
        }

        .sub-nav-item.hadiths {
            background-color: #6d2f00;
        }

        .sub-nav-item.hadiths:hover {
            background-color: #8a3b00;
        }

        .sub-nav-item.hadiths.active {
            background-color: rgba(255,255,255,0.15);
            font-weight: bold;
        }

        .sub-menu.jesus_messiah {
            background-color: rgba(184, 134, 11, 0.2);
            border-left: 3px solid #ffffff;
        }

        .sub-nav-item.jesus_messiah {
            background-color: #8f6a09;
        }

        .sub-nav-item.jesus_messiah:hover {
            background-color: #a87f0b;
        }

        .sub-nav-item.jesus_messiah.active {
            background-color: rgba(255,255,255,0.15);
            font-weight: bold;
        }

        .nav-arrow {
            float: right;
            transition: transform 0.3s ease;
        }

        .nav-arrow::before {
            content: '';
            display: inline-block;
            width: 0;
            height: 0;
            border-left: 6px solid white;
            border-top: 4px solid transparent;
            border-bottom: 4px solid transparent;
        }

        .nav-arrow.expanded {
            transform: rotate(90deg);
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 50px;
            background-color: white;
            margin: 20px 20px 20px 0;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .welcome-section {
            text-align: center;
            padding: 60px 20px;
        }

        .welcome-section h1 {
            color: #28a745;
            font-size: 36px;
            margin-bottom: 20px;
        }

        .welcome-section p {
            font-size: 18px;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .content-section h2 {
            color: #504d4d;
            font-size: 28px;
            margin-bottom: 20px;
            border-bottom: 2px solid #443f3f;
            padding-bottom: 10px;
        }

        .content-section p {
            font-size: 16px;
            line-height: 1.8;
            color: #555;
            margin-bottom: 15px;
        }

        .introduction {
            font-size: 18px;
            color: #444;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(to right, #f8f9fa, #ffffff);
            border-left: 4px solid #3c3c3c;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .sources-container {
            margin-top: 20px;
        }

        .source-item {
            margin-bottom: 25px;
            padding: 20px;
            background-color: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .source-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }

        .source-title {
            font-weight: bold;
            color: #28a745;
            font-size: 16px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        
        .source-title.bible {
            color: #ffd700;
        }

        .source-title.bibleot {
            color: #ff8800 
        }

        .source-icon {
            font-size: 18px;
            min-width: 20px;
        }

        .source-icon.quran {
            color: #28a745;
        }

        .source-icon.hadith {
            color: #dc3545;
        }

        .source-icon.other {
            color: #6c757d;
        }

        .source-icon.image {
            color: #007bff;
        }

        .grading {
            font-size: 14px;
            color: #6c757d;
            font-weight: normal;
            margin-top: 5px;
            font-style: italic;
        }

        /* Image Source Styles */
        .image-container {
            margin-top: 15px;
            text-align: center;
        }

        .source-image {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        /* Image size variants */
        .source-image.small {
            max-width: 200px;
        }

        .source-image.medium {
            max-width: 400px;
        }

        .source-image.large {
            max-width: 600px;
        }

        .source-image.full {
            max-width: 100%;
        }

        .image-caption {
            font-size: 14px;
            color: #6c757d;
            margin-top: 10px;
            font-style: italic;
        }

        .source-text {
            font-size: 15px;
            line-height: 1.7;
            color: #555;
            font-style: italic;
        }

        /* colors */ 

       
        blue {
            color: blue;
        }
        
        red {
            color: red;
        }
        
        green {
            color: green;
        }

       

        purple {
            color: purple;
        }
        orange {
            color: orange
        }
        bblue {
            color: rgb(123, 185, 229)
        }
        
        gold {
            color: gold
        }
        silver {
            color: silver
        }
        iron {
            color: rgb(0, 0, 0)
        }
        bronze {
            color: orangered
        }

        brown {
            color: brown
        }

     
        

        /* Commentary Styles */
        .commentary {
            font-size: 16px;
            color: #444;
            margin: 25px 0;
            padding: 25px;
            background: linear-gradient(to right, #f8f9fa, #ffffff);
            border-left: 4px solid #17a2b8;
            border-radius: 8px;
            line-height: 1.7;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        /* Social Links Styles */
        .social-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-top: 10px;
        }
        .social-card {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            text-decoration: none;
            color: inherit;
            transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
        }
        .social-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            background: #ffffff;
        }
        .social-card .social-icon {
            width: 40px;
            height: 40px;
            display: inline-block;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }
        .social-card .social-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .social-card .social-label { font-weight: 600; }
        .social-card.discord .social-label { font-size: 18px; }
        .social-card.featured { grid-column: span 2; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                order: 2;
            }
            
            .main-content {
                margin: 10px 10px 10px 10px;
                padding: 20px;
                order: 1;
            }
            .social-card.featured { grid-column: auto; }
        }

        /* Comments Styles */
        .comments-section { margin-top: 30px; padding-top: 20px; border-top: 2px solid #e9ecef; }
        .comments-title { font-size: 22px; color: #28a745; margin-bottom: 12px; }
        .comment-item { padding: 12px 14px; border: 1px solid #e9ecef; border-radius: 8px; background: #fafafa; margin-bottom: 10px; }
        .comment-header { display:flex; justify-content: space-between; align-items:center; margin-bottom: 6px; }
        .comment-author { font-weight: 600; color: #333; }
        .comment-date { font-size: 12px; color: #888; }
        .comment-text { color:#444; line-height:1.6; white-space: pre-wrap; }
        .comment-form { display:flex; flex-direction: column; gap: 8px; margin-top: 12px; }
        .comment-input, .comment-name { padding:10px; border:1px solid #ced4da; border-radius:6px; width:100%; }
        .comment-submit { align-self:flex-start; background:#28a745; color:white; border:none; padding:10px 14px; border-radius:6px; cursor:pointer; }
        .comment-submit:hover { background:#218838; }

        /* Likes Styles */
        .likes-section { margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; display: flex; align-items: center; gap: 10px; }
        .like-button { background: none; border: none; cursor: pointer; font-size: 16px; font-weight: bold; transition: transform 0.2s; }
        .like-button:hover { transform: scale(1.1); }
        .like-button.liked { color: #28a745; }
        .like-count { font-size: 16px; font-weight: bold; color: #333; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <h2>Navigation</h2>
            <div id="nav-menu">
                <!-- Navigation items will be generated by JavaScript -->
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
             
            <!-- Welcome Section -->
            <div id="welcome" class="welcome-section">
                <h1>Welcome</h1>
                <p>Explore the different sections using the navigation menu on the left (or at the bottom) to read about my personal criticism regarding Atheism. Each section contains a different topic with Islamic sources and my commentary. SITE NOT FINISHED</p>
            </div>

            <!-- Dynamic Content Sections -->
            <div id="content-area">
                <!-- Content sections will be generated by JavaScript -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Function to generate source URLs
        // Function to generate source URLs

        // function bibleGatewayUrlFromTitle(title) {
        //     // Trim and normalize spaces
        //     const s = title.trim().replace(/\s+/g, ' ');
        //     // Match: book name (anything) + space + chapter (digits) + ":" + verse or verse-range (digits or digits-digits)
        //     const m = s.match(/^(.+?)\s+(\d+):(\d+(?:-\d+)?)$/);
        //     if (!m) throw new Error('Invalid title format. Expected "BookName Chapter:Verse" (e.g. "Isaiah 61:5" or "Isaiah 61:5-7").');

        //     const book = m[1];           // e.g. "Isaiah" or "1 John"
        //     const chapter = m[2];        // e.g. "61"
        //     const versePart = m[3];      // e.g. "5" or "5-7"

        //     const query = `${book} ${chapter}:${versePart}`;
        //     const encoded = encodeURIComponent(query); // spaces -> %20, ":" -> %3A, "-" stays "-"
        //     return `https://www.biblegateway.com/passage/?search=${encoded}&version=ESV`;
        // }

        function bibleGatewayUrl(title) {
            const s = title.trim().replace(/\s+/g, ' ');

            // Match "Book Chapter:Verse[-Verse]" or "Book Chapter"
            const chapterVersePattern = /^(.+?)\s+(\d+):(\d+(?:-\d+)?)$/; // book, chapter, verse/verse-range
            const chapterOnlyPattern = /^(.+?)\s+(\d+)$/;                 // book, chapter only

            let query;

            const chapterVerseMatch = s.match(chapterVersePattern);
            const chapterOnlyMatch = s.match(chapterOnlyPattern);

            if (chapterVerseMatch) {
                const book = chapterVerseMatch[1];
                const chapter = chapterVerseMatch[2];
                const versePart = chapterVerseMatch[3];
                query = `${book} ${chapter}:${versePart}`;
            } else if (chapterOnlyMatch) {
                const book = chapterOnlyMatch[1];
                const chapter = chapterOnlyMatch[2];
                query = `${book} ${chapter}`;
            } else {
                throw new Error('Invalid title format. Expected "Book Chapter" or "Book Chapter:Verse[-Verse]".');
            }

            const encoded = encodeURIComponent(query);
            return `https://www.biblegateway.com/passage/?search=${encoded}&version=ESV`;
            }


        function generateSourceUrl(title, type, sourceUrl = null) {
            if (type === 'quran') {
                // Extract chapter and verse from Quran titles like "Quran 2:223"
                const match = title.match(/(\d+):(\d+)/);
                if (match) {
                    const chapter = match[1];
                    const verse = match[2];
                    return `https://quranx.com/${chapter}.${verse}`;
                }
            }
            else if (type === 'bibleot' || type === 'bible') {
                // Extract chapter and verse from Quran titles like "Quran 2:223"
                console.log(title);
                if (title !== "") {
                    return bibleGatewayUrl(title);
                }
                
            }

            else if (type === 'hadith') {
                // Common regex for hadith numbers with optional letter suffix
                const match = title.match(/(\d+[a-z]?)/i);

                if (title.toLowerCase().includes('bukhari') && match) {
                    return `https://sunnah.com/bukhari:${match[1]}`;
                }
                else if (title.toLowerCase().includes('muslim') && match) {
                    return `https://sunnah.com/muslim:${match[1]}`;
                }
                else if (title.toLowerCase().includes('nasa') && match) {
                    return `https://sunnah.com/nasai:${match[1]}`;
                }
                else if (title.toLowerCase().includes('dawud') && match) {
                    return `https://sunnah.com/abudawud:${match[1]}`;
                }
                else if (title.toLowerCase().includes('majah') && match) {
                    return `https://sunnah.com/ibnmajah:${match[1]}`;
                }
                else if (title.toLowerCase().includes('at-tirmidhi') && match) {
                    return `https://sunnah.com/tirmidhi:${match[1]}`;
                }
                else if (title.toLowerCase().includes('al-mufrad') && match) {
                    return `https://sunnah.com/adab:${match[1]}`;
                }
                else if (title.toLowerCase().includes('as-salihin') && match) {
                    return `https://sunnah.com/riyadussalihin:${match[1]}`;
                }

                else if (title.toLowerCase().includes('al-masabih') && match) {
                    return `https://sunnah.com/mishkat:${match[1]}`;
                }
            }
            else if (sourceUrl) {
                // Use the provided source URL for "other" type sources
                return sourceUrl;
            }
            
            // Default fallback for all other sources
            return 'https://islam.com';
        }


        // Function to convert Markdown-style links to HTML
        function parseMarkdownLinks(text) {
            // Convert [text](url) to <a href="url" target="_blank">text</a>
            return text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>');
        }

        // Content Database - Easy to modify and add new sections
        const contentDatabase = {
            // "about": {
            //     title: "About Me",
            //     subTopics: {
            //         "mission": {
            //             title: "My Mission",
            //             introduction: "My mission is to expose errors and falsities in popular heretical sects such as: Islam, Modern Judaism, Mormonism, Unitarianism, Jehovas witnesses, and more.",
            //             sources: [
            //                 // Example of how to add an image:
            //                 // {
            //                 //     title: "Example Image",
            //                 //     text: "images/example.jpg", // Path to your local image file
            //                 //     type: "image",
            //                 //     size: "medium", // Options: "small" (200px), "medium" (400px), "large" (600px), "full" (100%)
            //                 //     caption: "Optional caption for the image" // Optional caption
            //                 // },
            //                 // {
            //                 //     title: "Mission Statement",
            //                 //     text: "We strive to present Islamic teachings in a clear, accessible manner while maintaining the authenticity and depth of the original sources. Our content is carefully curated and reviewed to ensure accuracy and relevance.",
            //                 //     type: "other",
            //                 //     source: "https://islam.com"
            //                 // },
            //                 // {
            //                 //     title: "Our Purpose",
            //                 //     text: "Whether you're seeking daily guidance, learning about Islamic principles, or exploring the rich history and culture of Islam, IslamBot is here to assist you on your journey of knowledge and spiritual growth.",
            //                 //     type: "other",
            //                 //     source: "https://islam.com"
            //                 // }
            //             ]
            //         },
            //         "credits": {
            //             title: "Credits",
            //             introduction: "Written by Dav, big thanks to the following websites (that i also sometimes directly quoted from): https://www.answering-islam.org/",
            //             sources: [
            //                 // {
            //                 //     title: "Research Team",
            //                 //     text: "Our research team consists of qualified Islamic scholars who verify all sources and ensure theological accuracy in our presentations.",
            //                 //     type: "other",
            //                 //     source: "https://islam.com"
            //                 // },
            //                 // {
            //                 //     title: "Technical Team",
            //                 //     text: "Our technical team works to make Islamic knowledge accessible through modern digital platforms while maintaining the integrity of the original sources.",
            //                 //     type: "other",
            //                 //     source: "https://islam.com"
            //                 // }
            //             ]
            //         },
            //         "contact": {
            //             title: "Contact Me",
            //             introduction: "Contact me through the platforms below:",
            //             sources: [
            //                 {
            //                     title: "Discord",
            //                     text: "Join the community on Discord",
            //                     type: "other",
            //                     source: "https://discord.gg/UhK5kXCA5h"
            //                 },
            //                 {
            //                     title: "TikTok",
            //                     text: "Follow me on TikTok",
            //                     type: "other",
            //                     source: "https://www.tiktok.com/@davxchrist"
            //                 },
            //                 {
            //                     title: "Telegram",
            //                     text: "Telegram channel/group",
            //                     type: "other",
            //                     source: ""
            //                 },
            //                 {
            //                     title: "Twitter",
            //                     text: "Follow on Twitter",
            //                     type: "other",
            //                     source: ""
            //                 },
            //                 {
            //                     title: "Email",
            //                     text: "Send me an email",
            //                     type: "other",
            //                     source: "mailto:#todo@example.com"
            //                 }
            //             ]
            //         }
            //     }
            // },
            
            
            // "disclaimer": {
            //     title: "Disclaimer",
            //     subTopics: {
            //         "Disclaimer": {
            //             title: "Disclaimer",
            //             introduction: "The intention of this website is not to insult Muslims. Anything i write is not an insult to Muslims, it is an attack towards Islam. Opinions and content on this site may come from various sources and are not necessarily all my own. If you want to share your criticism regarding this site, you may email me at davxchrist333@gmail.com. ",
                        
                        
            //             sources: [


                           
            //             ]
            //         }
            //     }
            // },

            
            "intro_atheism": {
                title: "Atheism - an Introduction",
                subTopics: {
                    "introduction": {
                        title: "Introduction to Atheism",
                        introduction: "Islam as a religion has grown greatly in popularity in the last years. Many ex-'Christians' from predominantly Christian countries gave up their weak faith to serve a different god, former atheists have discovered Islam after having listened to Dawah boys, and tons more are converting to it every day. the trick behind it is simple: refashion Arian beliefs, lie about Christianity and the Bible, lie about Islam and the Quran, and lie about basically anything else. to the average person it the idea of one god, one prophet, and one book seems plausible, very easy to understand, very logical. but truth does not care about how things appear, rather, it cares about how things are. unfortunately this very idea looks a bit different in reality. i consider Islam of the greatest, best and most dangerous deceptions and traps that have ever emerged on the planet. Islam is the most dangerous lie that ever existed, Satan's masterpiece. on this website, i challenge and expose Islamic teachings and the lies drawn by Muslims, and offer reliable Islamic sources supporting my objections.",                        sources: [


                            {
                                title: "Sahih Muslim 146",
                                text: "It is narrated on the authority of Ibn 'Umar ('Abdullah b. 'Umar) that the Messenger of Allah (ï·º) observed: Verily Islam started as something strange and it would again revert (to its old position) of being strange just as it started, and it would recede between the two mosques just as the serpent crawls back into its hole.",
                                type: "hadith",
                                grading: "Sahih (Authentic)"
                            }
                            // Example of how to add an image:
                            // {
                            //     title: "Example Image",
                            //     text: "images/example.jpg", // Path to your local image file
                            //     type: "image",
                            //     size: "medium", // Options: "small" (200px), "medium" (400px), "large" (600px), "full" (100%)
                            //     caption: "Optional caption for the image" // Optional caption
                            // },
                            // {
                            //     title: "Mission Statement",
                            //     text: "We strive to present Islamic teachings in a clear, accessible manner while maintaining the authenticity and depth of the original sources. Our content is carefully curated and reviewed to ensure accuracy and relevance.",
                            //     type: "other",
                            //     source: "https://islam.com"
                            // },
                            // {
                            //     title: "Our Purpose",
                            //     text: "Whether you're seeking daily guidance, learning about Islamic principles, or exploring the rich history and culture of Islam, IslamBot is here to assist you on your journey of knowledge and spiritual growth.",
                            //     type: "other",
                            //     source: "https://islam.com"
                            // }
                        ]
                    },
                  
                }
            },

            
            "common_objections": {
                title: "Common Objections",
                subTopics: {
                    "omniscience": {
                        title: "Omniscience contradicts goodness 1",
                        introduction: "",                        sources: [

                        {
                            type: "commentary",
                            text: "Argument 1:"
                        },

                        {
                            type: "commentary",
                            text: "If God is all knowing and exists out of time, he knows before the birth of any person whether that person would go to heaven or hell. It is thus evil and cruel to create a person knowing he/she would go to hell."
                        },
                        {
                            type: "commentary",
                            text: "Here is the problem with the argument:<br><br>1. The creation of a new soul is initiated by a male and a female person having intercourse and practicing that which God has made holy (in marriage) for us.<br>2. A new human being with a new soul is created. God does not pre-decide the actions of this person.<br>3. The person is born and as we all, sins and falls short of the glory of God.<br>4. Therefore, because he has sinned (by his own will), he is in need of a savior.<br>5. The person now has the choice between seeking God or ignoring Him, despite the fact God knew which one he/she would pick, He is not the one who made this person decide anything, yet He is already aware of this soul's fate.<br>6. Rejecting God (by free will), the person may be eternally seperated from His love.<br><br>Therefore it is in no way cruel, evil or unjust, as God gave each of us the choice between seeking Him or not, and God likewise gave us free will to bring new life into this world by what He has already set up. The critic assumes God mindlessly creates human beings and sets them into this world, knowing they would go to hell. This is not the case. The act and decision of procreation is done by human beings. God does not predestine what a person would do after his birth, but He has full knowledge on it. As long as free will exists on this earth, sin exists.  "
                        },
                        ]
                    },
                  
                }
            },

            
            "arguments_against_atheism": {
                title: "Arguments against Atheism",
                subTopics: {
                    "args_against_atheism": {
                        title: "The problem of morality",
                        introduction: "Atheists must concede to the fact that their entire morality is subjective and rather than based on truth it is based on a personal opinion and personal preferences.",                        sources: [

                        {
                            type: "commentary",
                            text: "What is evil and what is good? Evil is to murder, to insult, to harm others, many would answer. But according to who? What if i disagree? Who of us is right? In a world with no God, the question will remain unanswered. To say correctly, i have my opinion on morality, and others have theirs. That does not invalidate or weaken my hypothetical opinion that murder is good though. Who says murder isn't good? Without God, nobody. Only fallible humans. An agreement on majority does not ensure that humanity gets it right either, as we could see from e.g. slavery, strong mysogyny throughout history, the burning of witches, etc. If the majority of people back then agreed slavery was right, was it actually right and indesputably moral? No, obviously not. Even if you claim to follow certain 'laws of logic' to determine good and bad, this very system is likewise created by man. Who says to judge by this specific set of 'logic'? There are no answers. In an atheist worldview, there is no wrong and right, and Atheists need to accept that.<br><br>Morality derives from God, the infallible, highest of beings. Here there is no dispute and we can properly define good and evil, because God has eternally declared it."
                        },

                        {
                            type: "commentary",
                            text: "And this very issue reflects most atheist societies, which is full of degeneracy and sin. That is why atheism is so dangerous. There IS no morality."
                        },
                        
                        ]
                    },
                  
                }
            },

            
        }
        // Generate navigation menu
        function generateNavigation() {
            const navMenu = document.getElementById('nav-menu');
            
            Object.keys(contentDatabase).forEach((key, index) => {
                const navItem = document.createElement('div');
                let navClass = 'nav-item';
                if (key === 'disclaimer' || key === 'intro_atheism') {
                    navClass += ' disclaimer';
                } else if (key === 'quotes') {
                    navClass += ' quotes';
                } else if (key === 'hadiths') {
                    navClass += ' hadiths';
                } else if (key === 'Jesus_messiah') {
                    navClass += ' jesus_messiah';
                }
                navItem.className = navClass;
                
                const titleSpan = document.createElement('span');
                titleSpan.textContent = contentDatabase[key].title;
                
                const arrow = document.createElement('span');
                arrow.className = 'nav-arrow';
                arrow.textContent = '';
                
                navItem.appendChild(titleSpan);
                navItem.appendChild(arrow);
                
                navItem.onclick = () => toggleSubMenu(key);
                
                // Create sub-menu
                let subMenuClass = 'sub-menu';
                if (key === 'disclaimer' || key === 'intro_islam') {
                    subMenuClass += ' disclaimer';
                } else if (key === 'quotes') {
                    subMenuClass += ' quotes';
                } else if (key === 'hadiths') {
                    subMenuClass += ' hadiths';
                } else if (key === 'Jesus_messiah') {
                    subMenuClass += ' jesus_messiah';
                }
                const subMenu = document.createElement('div');
                subMenu.className = subMenuClass;
                subMenu.id = `sub-${key}`;

                Object.keys(contentDatabase[key].subTopics).forEach(subKey => {
                    let subNavClass = 'sub-nav-item';
                    if (key === 'disclaimer' || key === 'intro_islam') {
                        subNavClass += ' disclaimer';
                    } else if (key === 'quotes') {
                        subNavClass += ' quotes';
                    } else if (key === 'hadiths') {
                        subNavClass += ' hadiths';
                    } else if (key === 'Jesus_messiah') {
                        subNavClass += ' jesus_messiah';
                    }
                    const subNavItem = document.createElement('div');
                    subNavItem.className = subNavClass;
                    subNavItem.textContent = contentDatabase[key].subTopics[subKey].title;
                    subNavItem.onclick = (e) => {
                        e.stopPropagation();
                        showContent(key, subKey);
                    };
                    subMenu.appendChild(subNavItem);
                });
                
                navMenu.appendChild(navItem);
                navMenu.appendChild(subMenu);
            });
        }

        // Toggle sub-menu visibility
        function toggleSubMenu(key) {
            const subMenu = document.getElementById(`sub-${key}`);
            const arrow = document.querySelector(`#nav-menu .nav-item:nth-child(${Object.keys(contentDatabase).indexOf(key) * 2 + 1}) .nav-arrow`);
            
            // Close all other sub-menus
            document.querySelectorAll('.sub-menu').forEach(menu => {
                if (menu.id !== `sub-${key}`) {
                    menu.classList.remove('show');
                }
            });
            document.querySelectorAll('.nav-arrow').forEach(arr => {
                if (arr !== arrow) {
                    arr.classList.remove('expanded');
                }
            });
            
            // Toggle current sub-menu
            subMenu.classList.toggle('show');
            arrow.classList.toggle('expanded');
        }

        // Generate content sections
        function generateContentSections() {
            const contentArea = document.getElementById('content-area');
            
            Object.keys(contentDatabase).forEach(key => {
                Object.keys(contentDatabase[key].subTopics).forEach(subKey => {
                    const section = document.createElement('div');
                    section.id = `${key}-${subKey}`;
                    section.className = 'content-section';
                    section.dataset.threadId = `${key}-${subKey}`; // thread id for comments
                    
                    // Create title
                    const title = document.createElement('h2');
                    title.textContent = contentDatabase[key].subTopics[subKey].title;
                    section.appendChild(title);
                    
                    // Create introduction
                    const introduction = document.createElement('div');
                    introduction.className = 'introduction';
                    introduction.textContent = contentDatabase[key].subTopics[subKey].introduction;
                    section.appendChild(introduction);
                    
                    // Create sources container
                    const sourcesContainer = document.createElement('div');
                    sourcesContainer.className = 'sources-container';
                    
                    // Add each source or commentary
                    contentDatabase[key].subTopics[subKey].sources.forEach(item => {
                        if (item.type === 'commentary') {
                            // Create commentary element
                            const commentary = document.createElement('div');
                            commentary.className = 'commentary';
                            commentary.innerHTML = parseMarkdownLinks(item.text);
                            sourcesContainer.appendChild(commentary);
                        } else {
                            // Create source element
                            const sourceItem = document.createElement('div');
                            sourceItem.className = 'source-item';
                            
                            const sourceTitle = document.createElement('div');
                            sourceTitle.className = 'source-title';
                               
                            // Add special styling for bible type
                            if (item.type === 'bible') {
                                sourceTitle.classList.add('bible');
                            }
                            if (item.type === 'bibleot') {
                                sourceTitle.classList.add('bibleot');
                            }
                            // Add icon based on source type
                            const icon = document.createElement('span');
                            icon.className = `source-icon ${item.type}`;
                            
                            if (item.type === 'quran') {
                                icon.textContent = 'ðŸ“–'; // Book emoji for Quran
                            } else if (item.type === 'hadith') {
                                icon.textContent = 'ðŸ“•'; // Scroll emoji for Hadith
                            } else if (item.type === 'bible') {
                                icon.textContent = 'âœï¸'; // Cross emoji for Bible
                            } else if (item.type === 'bibleot') {
                                icon.textContent = 'ðŸ“˜';
                            } else if (item.type === 'image') {
                                icon.textContent = 'ðŸ–¼ï¸'; // Picture emoji for images
                            } else if (item.type === 'other'){
                                // If it's a social link, render with custom cards
                                const isSocial = ['Discord','TikTok','Telegram','Twitter','Email'].includes(item.title);
                                if (isSocial) {
                                    // Build once per section
                                    if (!sourcesContainer.dataset.socialBuilt) {
                                        const socialWrap = document.createElement('div');
                                        socialWrap.className = 'social-links';

                                        const socialTitles = ['Discord','TikTok','Telegram','Twitter','Email'];
                                        const platforms = contentDatabase[key].subTopics[subKey].sources
                                            .filter(s => s.type === 'other' && socialTitles.includes(s.title));

                                        platforms.forEach(p => {
                                            const a = document.createElement('a');
                                            const keyName = p.title.toLowerCase();
                                            a.href = p.source || '#';
                                            a.target = '_blank';
                                            a.rel = 'noopener noreferrer';
                                            a.className = `social-card ${keyName}${keyName==='discord' ? ' featured' : ''}`;

                                            const iconSpan = document.createElement('span');
                                            iconSpan.className = 'social-icon';
                                            const img = document.createElement('img');
                                            img.src = (
                                                keyName === 'discord' ? 'discord.jpg' :
                                                keyName === 'tiktok' ? 'tiktok.jpg' :
                                                keyName === 'telegram' ? 'telegram.png' :
                                                keyName === 'twitter' ? 'x.jpg' :
                                                'gmail.png'
                                            );
                                            img.alt = `${p.title} icon`;
                                            iconSpan.appendChild(img);

                                            const label = document.createElement('span');
                                            label.className = 'social-label';
                                            label.textContent = p.title;

                                            a.appendChild(iconSpan);
                                            a.appendChild(label);
                                              // ðŸ”¹ Custom behavior for Gmail
                                            if (keyName === 'email') {
                                                a.removeAttribute('href'); // remove mailto link
                                                a.onclick = (e) => {
                                                    e.preventDefault();
                                                    alert("You can email me here: davxchrist333@gmail.com");
                                                };
                                            }
                                            socialWrap.appendChild(a);
                                        });

                                        // Replace default source block with social cards (single block)
                                        sourceItem.appendChild(socialWrap);
                                        sourcesContainer.appendChild(sourceItem);
                                        sourcesContainer.dataset.socialBuilt = '1';
                                    }
                                    return; // skip default rendering for social items (already handled)
                                } else {
                                    icon.textContent = 'ðŸ“™'; // Document emoji for other sources
                                }
                            } else {
                                icon.textContent = 'ðŸ“š'
                            }
                            
                            const titleText = document.createElement('a');
                            titleText.textContent = item.title;
                            titleText.href = generateSourceUrl(item.title, item.type, item.source);
                            titleText.target = '_blank';
                            titleText.style.textDecoration = 'none';
                            titleText.style.color = 'inherit';
                            
                            sourceTitle.appendChild(icon);
                            sourceTitle.appendChild(titleText);
                            
                            // Add grading for hadiths
                            if (item.type === 'hadith' && item.grading) {
                                const grading = document.createElement('div');
                                grading.className = 'grading';
                                grading.textContent = `Grading: ${item.grading}`;
                                sourceTitle.appendChild(grading);
                            }
                            
                            // Handle different content types
                            if (item.type === 'image') {
                                // Create image container
                                const imageContainer = document.createElement('div');
                                imageContainer.className = 'image-container';
                                
                                const img = document.createElement('img');
                                img.className = 'source-image';
                                
                                // Add size class if specified (default to medium if not specified)
                                const size = item.size || 'medium';
                                img.classList.add(size);
                                
                                img.src = item.text; // For images, 'text' field contains the image path
                                img.alt = item.title;
                                
                                imageContainer.appendChild(img);
                                
                                // Add caption if provided
                                if (item.caption) {
                                    const caption = document.createElement('div');
                                    caption.className = 'image-caption';
                                    caption.textContent = item.caption;
                                    imageContainer.appendChild(caption);
                                }
                                
                                sourceItem.appendChild(sourceTitle);
                                sourceItem.appendChild(imageContainer);
                            } else {
                                // Regular text content
                                const sourceText = document.createElement('div');
                                sourceText.className = 'source-text';
                                sourceText.innerHTML = `"${item.text}"`;
                                
                                sourceItem.appendChild(sourceTitle);
                                sourceItem.appendChild(sourceText);
                            }
                            
                            sourcesContainer.appendChild(sourceItem);
                        }
                    });
                    
                    section.appendChild(sourcesContainer);
                    contentArea.appendChild(section);
                });
            });
        }

        // Show specific content section
        function showContent(sectionId, subSectionId) {
            // Hide welcome section
            document.getElementById('welcome').style.display = 'none';

            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });

            // Show selected section
            const targetId = `${sectionId}-${subSectionId}`;
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }

            // Update navigation active state
            document.querySelectorAll('.sub-nav-item').forEach(item => {
                item.classList.remove('active');
            });

            // Find and activate the clicked sub-nav item
            const subMenu = document.getElementById(`sub-${sectionId}`);
            if (subMenu) {
                const subNavItems = subMenu.querySelectorAll('.sub-nav-item');
                const subKeys = Object.keys(contentDatabase[sectionId].subTopics);
                const targetIndex = subKeys.indexOf(subSectionId);
                if (targetIndex >= 0 && subNavItems[targetIndex]) {
                    subNavItems[targetIndex].classList.add('active');
                }
            }

            // Update URL hash without triggering page reload
            const hash = `#${sectionId}-${subSectionId}`;
            if (window.location.hash !== hash) {
                history.replaceState(null, null, hash);
            }
        }

        // Supabase comments setup
        const supabaseUrl = 'https://ydptajhdqhiwjlozqybl.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkcHRhamhkcWhpd2psb3pxeWJsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc4MDA2MTUsImV4cCI6MjA3MzM3NjYxNX0.F6ezrGuNC9UfAlb6I9wXgI6wuS1TJvDsC6BHrR5yCHQ';
        const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);

        const COMMENT_MAX_LENGTH = 1000; // max characters per comment

        async function loadComments(threadId) {
            const { data, error } = await supabaseClient
                .from('comments')
                .select('*')
                .eq('thread_id', threadId)
                .order('created_at', { ascending: true });
            if (error) { console.error('Error loading comments', error); return []; }
            return data || [];
        }

        async function postComment(threadId, authorName, content) {
            const { error } = await supabaseClient
                .from('comments')
                .insert({ thread_id: threadId, author_name: authorName || null, content });
            if (error) { throw error; }
        }

        // Likes functions
        async function loadLikes(threadId) {
            const { data, error } = await supabaseClient
                .from('likes')
                .select('count')
                .eq('thread_id', threadId)
                .single();
            if (error && error.code !== 'PGRST116') { // PGRST116 is "not found"
                console.error('Error loading likes', error);
                return 0;
            }
            return data ? data.count : 0;
        }

        async function incrementLikes(threadId) {
            // First, try to get current count
            const { data: existing, error: selectError } = await supabaseClient
                .from('likes')
                .select('count')
                .eq('thread_id', threadId)
                .single();

            if (selectError && selectError.code !== 'PGRST116') {
                console.error('Error selecting likes', selectError);
                throw selectError;
            }

            let newCount;
            if (existing) {
                // Update existing
                newCount = existing.count + 1;
                const { error } = await supabaseClient
                    .from('likes')
                    .update({ count: newCount })
                    .eq('thread_id', threadId);
                if (error) {
                    console.error('Error updating likes', error);
                    throw error;
                }
            } else {
                // Insert new
                newCount = 1;
                const { error } = await supabaseClient
                    .from('likes')
                    .insert({ thread_id: threadId, count: newCount });
                if (error) {
                    console.error('Error inserting likes', error);
                    throw error;
                }
            }
            return newCount;
        }

        function createCommentElement(c) {
            const el = document.createElement('div');
            el.className = 'comment-item';
            const date = c.created_at ? new Date(c.created_at) : new Date();
            el.innerHTML = `
                <div class="comment-header">
                    <div class="comment-author">${(c.author_name && c.author_name.trim()) ? c.author_name.replace(/[<>]/g,'') : 'Anonymous'}</div>
                    <div class="comment-date">${date.toLocaleString()}</div>
                </div>
                <div class="comment-text"></div>
            `;
            el.querySelector('.comment-text').textContent = c.content || '';
            return el;
        }

        const commentsChannels = {};
        function subscribeToThread(threadId, listEl) {
            if (commentsChannels[threadId]) return;
            const channel = supabaseClient.channel(`comments-${threadId}`)
                .on('postgres_changes', {
                    event: 'INSERT',
                    schema: 'public',
                    table: 'comments',
                    filter: `thread_id=eq.${threadId}`
                }, (payload) => {
                    const c = payload.new;
                    listEl.appendChild(createCommentElement(c));
                })
                .subscribe();
            commentsChannels[threadId] = channel;
        }

        const likesChannels = {};
        function subscribeToLikes(threadId, countEl) {
            if (likesChannels[threadId]) return;
            const channel = supabaseClient.channel(`likes-${threadId}`)
                .on('postgres_changes', {
                    event: '*', // Listen to all changes (INSERT, UPDATE, DELETE)
                    schema: 'public',
                    table: 'likes',
                    filter: `thread_id=eq.${threadId}`
                }, (payload) => {
                    if (payload.new) {
                        countEl.textContent = payload.new.count;
                    } else if (payload.eventType === 'DELETE') {
                        countEl.textContent = '0';
                    }
                })
                .subscribe();
            likesChannels[threadId] = channel;
        }

        function ensureCommentsUI(section) {
            if (section.querySelector('.comments-section')) return;
            const threadId = section.dataset.threadId || section.id;

            // Add likes section
            const likesSection = document.createElement('div');
            likesSection.className = 'likes-section';
            likesSection.innerHTML = `
                <button class="like-button" title="Like this article">Like</button>
                <span class="like-count">0</span> likes
            `;
            section.appendChild(likesSection);

            const likeButton = likesSection.querySelector('.like-button');
            const likeCount = likesSection.querySelector('.like-count');

            // Load initial likes count
            loadLikes(threadId).then(count => {
                likeCount.textContent = count;
            });

            // Subscribe to real-time updates
            subscribeToLikes(threadId, likeCount);

            // Handle like button click
            likeButton.addEventListener('click', async () => {
                if (localStorage.getItem(`liked-${threadId}`) === 'true') {
                    alert('You already liked this article.');
                    return;
                }

                likeButton.disabled = true;
                likeButton.classList.add('liked');

                try {
                    const newCount = await incrementLikes(threadId);
                    likeCount.textContent = newCount;
                    localStorage.setItem(`liked-${threadId}`, 'true');
                } catch (err) {
                    console.error('Failed to like', err);
                    alert('Failed to like the article.');
                    likeButton.classList.remove('liked');
                } finally {
                    likeButton.disabled = false;
                }

            });

            const commentsSection = document.createElement('div');
            commentsSection.className = 'comments-section';
            commentsSection.innerHTML = `
                <div class="comments-title">Comments</div>
                <div class="comments-list"></div>
                <form class="comment-form">
                    <input type="text" class="comment-name" placeholder="Your name (optional)" />
                    <textarea class="comment-input" rows="3" placeholder="Write a comment..." maxlength="1000"></textarea>
                    <div class="comment-hint" style="font-size:12px;color:#888;margin:4px 0 8px;">Max 1000 characters</div>
                    <button type="submit" class="comment-submit">Post Comment</button>
                </form>
            `;
            section.appendChild(commentsSection);

            const listEl = commentsSection.querySelector('.comments-list');
            const form = commentsSection.querySelector('.comment-form');
            const nameInput = commentsSection.querySelector('.comment-name');
            const textInput = commentsSection.querySelector('.comment-input');

            // Load existing
            loadComments(threadId).then(comments => {
                comments.forEach(c => listEl.appendChild(createCommentElement(c)));
            });

            // Realtime
            subscribeToThread(threadId, listEl);

            // Handle submit
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = nameInput.value.trim();
                let text = textInput.value.trim();
                if (!text) return;
                if (text.length > COMMENT_MAX_LENGTH) {
                    alert(`Comment is too long. Maximum is ${COMMENT_MAX_LENGTH} characters.`);
                    return;
                }
                form.querySelector('.comment-submit').disabled = true;
                try {
                    await postComment(threadId, name, text);
                    textInput.value = '';
                } catch (err) {
                    console.error('Failed to post comment', err);
                    alert('Failed to post comment.');
                } finally {
                    form.querySelector('.comment-submit').disabled = false;
                }
            });
        }

        function initCommentsForAllSections() {
            document.querySelectorAll('.content-section').forEach(section => ensureCommentsUI(section));
        }

        // Parse URL hash and show appropriate content
        function handleUrlHash() {
            const hash = window.location.hash.substring(1); // Remove the '#'
            if (hash) {
                const parts = hash.split('-', 2); // Split into section and subsection
                if (parts.length === 2) {
                    const sectionId = parts[0];
                    const subSectionId = parts.slice(1).join('-'); // Rejoin in case subsection has dashes

                    // Check if the section and subsection exist
                    if (contentDatabase[sectionId] && contentDatabase[sectionId].subTopics[subSectionId]) {
                        showContent(sectionId, subSectionId);
                        return true;
                    }
                }
            }
            return false;
        }

        // Handle browser back/forward navigation
        window.addEventListener('popstate', function() {
            handleUrlHash();
        });

        // Initialize the website
        document.addEventListener('DOMContentLoaded', function() {
            generateNavigation();
            generateContentSections();
           // initCommentsForAllSections();

            // Check URL hash on page load
            handleUrlHash();
        });
    </script>
</body>
</html>